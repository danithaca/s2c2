{% load p2_tags %}
{% load static %}
{% load account_tags %}
{% load tz %}

<div class="engagement panel panel-{{ engagement.display_status.color }} hover-pointer engagement-headline" data-href="{{ engagement.get_link }}">
  <div class="panel-heading panel-title">Upcoming</div>
  <div class="panel-body">
    <div class="row vertical-align">
      <div class="col-xs-4 center-block">
      {# only show "client" if the main user is "server", and vice versa #}
      {% if engagement.is_main_match %}
        {% include 'account/view/compact.html' with user=engagement.initiate_user icon='elements/icon_serve.html' color=engagement.display_status.color only %}
      {% else %}
        {% if engagement.target_user %}
          {% include 'account/view/compact.html' with user=engagement.target_user icon='elements/icon_find.html' color=engagement.display_status.color only %}
        {% else %}
          {% include 'account/view/compact.html' with user=None hide_name=True icon='elements/icon_find.html' color=engagement.display_status.color only %}
        {% endif %}
      {% endif %}
      </div>

      <div class="col-xs-8">
        <h4 class="text-center">{{ engagement.contract.event_start|timeuntil }}</h4>
        <ul class="list-inline text-center">
          <li><i class="fa fa-clock-o"></i> <strong>{{ engagement.contract.event_start|date:'H:i, M. j' }}</strong></li>
          <li><i class="fa fa-money"></i>
            {% if engagement.contract.price > 0 %}
              <strong>${{ engagement.contract.price }}</strong>
            {% else %}
              <strong>$0</strong> (favor exchange)
            {% endif %}
          </li>
        </ul>
        {% if engagement.contract.description %}
          <p class="text-center">{{ engagement.contract.description|truncatechars:100 }}</p>
        {% endif %}
        {#      {% if engagement.target_user %}#}
        {#      <p class="truncate">#}
        {#        <a href="{% url 'account_view' pk=engagement.target_user.id %}">{% user-full-name engagement.target_user %}</a>#}
        {#      </p>#}
        {#      {% endif %}#}
      </div>
    </div>
  </div>
</div>