{% extends 'base.html' %}
{% load account_tags %}
{% load p2_tags %}
{% load bootstrap %}

{% block extra_header %}
  {% include 'includes/js_grid.html' %}
  <style>
  #content-introduction  {
    min-height: 190px;
  }
  </style>
{% endblock %}

{% block panel-attributes %}data-uid="{{ target_user.id }}"{% endblock %}

{% block content-command-list %}
  {% if current_user != target_user %}
    <div class="btn-group btn-group-xs">
    <a class="btn btn-primary btn-xs" href="{% url 'shout:user' uid=target_user.id %}"><i class="fa fa-bullhorn"></i> Message</a>
    {% if user_membership %}
      <a href="{% url 'circle:membership_edit' pk=user_membership.id %}" class="btn btn-xs btn-warning" title="{{ user_membership.note|default:'No endorsement statement.' }}" data-toggle="tooltip"><i class="fa fa-edit"></i> Edit Connection</a>
    {% else %}
      {% if target_user.is_sitter %}
        <a href="{% url 'circle:sitter_add' uid=target_user.id %}" class="btn btn-xs btn-success"><i class="fa fa-user-plus"></i> Add to My Network</a>
      {% else %}
        <a href="{% url 'circle:parent_add' uid=target_user.id %}" class="btn btn-xs btn-success"><i class="fa fa-user-plus"></i> Add to My Network</a>
      {% endif %}
    {% endif %}
    </div>
  {% else %}
    <div class="btn-group btn-group-xs">
      <div class="btn-group btn-group-xs">
        <button class="btn btn-primary dropdown-toggle" data-toggle="dropdown"><i class="fa fa-pencil"></i> Edit Account <span class="caret"></span></button>
        <ul class="dropdown-menu">
          {% for menu_item in edit_account_menu_items %}
            <li><a href="{{ menu_item.1 }}">{{ menu_item.0 }}</a></li>
          {% endfor %}
        </ul>
      </div>
      <a class="btn btn-default" href="{% url 'account_logout' %}"><i class="fa fa-sign-out"></i> Log out</a>
    </div>
  {% endif %}
{% endblock %}

{% block content-introduction %}
  {% if current_user == target_user %}
    <a href="{% url 'account_picture' %}"><img src="{% user_picture_url target_user %}" align="right" alt="user picture" class="img-thumbnail img-round img-150"></a>
  {% else %}
    <img src="{% user_picture_url target_user %}" align="right" alt="user picture" class="img-thumbnail img-round img-150">
  {% endif %}
  <p class="section-title">
    {% user-full-name target_user %}
  </p>
  <p class="text-large">
    {% if not target_user.is_registered %}<span class="label label-danger">Unregistered</span>{% endif %}
    {% include 'elements/user_level.html' with user=target_user only %}
    {% if interactions %}{% include 'elements/interactions.html' with count=interactions help='Previous number of interactions with this user on babysitting.' %}{% endif %}
  </p>
  {% if reverse_user_connection.trusted %}
    <ul class="list-inline">
      <li><i class="fa fa-envelope"></i> {{ target_user.email }}</li>
      {% if target_user.info.phone %}
        <li><i class="fa fa-phone"></i> {{ target_user.info.phone }}</li>
      {% endif %}
      {% if target_user.info.address %}
        <li><i class="fa fa-map-marker"></i> {{ target_user.info.address }} <a href="https://www.google.com/maps/place/{{ target_user.info.address|urlencode }}" target="_blank"><i class="fa fa-external-link"></i></a></li>
      {% endif %}
    </ul>
  {% endif %}
  {% if target_user.info.note %}
    <p class="text-large">{{ target_user.info.note }}</p>
  {% endif %}
{% endblock %}

{% block content %}
{#  <div class="min-margin-bottom">#}
{#    {% for circle in current_user_shared_circles %}#}
{#      {% if circle.owner == current_user %}#}
{#        <span class="label label-success">{{ circle.display }}</span>#}
{#      {% else %}#}
{#        <span class="label label-primary">{{ circle.display }}</span>#}
{#      {% endif %}#}
{#    {% endfor %}#}
{#  </div>#}

  {% if list_personal_membership or list_public_membership %}
  <div class="section-title">Connections & Social Groups</div>
  <div class="grid">
    {% for membership in list_personal_membership %}
      <div class="grid-item">{% include 'includes/card/membership.html' with membership=membership user=membership.member.to_puser only %}</div>
    {% endfor %}
    {% for membership in list_public_membership %}
      <div class="grid-item">{% include 'includes/card/group.html' with circle=membership.circle only %}</div>
    {% endfor %}
  </div>
  {% endif %}

{% endblock %}
