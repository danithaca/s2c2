{% extends "base_s.html" %}
{% load p2_tags %}

{% block title %}Dashboard{% endblock %}

{% block extra_header %}
<script type="text/javascript">
  $(document).ready(function() {
    $('[data-toggle="popover"]').popover({
      trigger: 'hover',
      placement: 'auto'
    });

    $('.engagement').click(function() {
      var href = $(this).data('href');
      if (href) {
        window.location = href;
      }
    });

{#    $('.help-icon').hide();#}
{#    $('.dashboard-link').hover(function() {#}
{#      $(this).find('.help-icon').show();#}
{#    }, function() {#}
{#      $(this).find('.help-icon').hide();#}
{#    });#}
  });
</script>
{% endblock %}

{% block content %}
{#  {% if target_user.is_onboard %}#}
{#  <div class="page-header">#}
{#    <h4><img class="img-circle img-50" src="{% user_picture_url target_user %}"> {% user-full-name user %}</h4>#}
{#  </div>#}
{#  {% endif %}#}
  {% if engagement_headline %}
    {% include 'contract/engagement_view/headline.html' with engagement=engagement_headline %}
  {% endif %}

  {% url 'contract:add' as href_contract_add %}
  {% include 'pages/dashboard_link.html' with color='success' href=href_contract_add text='Find a Babysitter' help="Want a babysitter either for a fee or for free (favor exchange)? Click the button and make a request." only %}

  {% url 'contract:calendar' as href_calendar %}
  {% include 'pages/dashboard_link.html' with color='success' href=href_calendar text='View Activities' help="Browse recent activies and view them in calendar." only %}

  {% url 'circle:manage_personal' as href_manage_contacts %}
  {% if target_user.is_isolated %}
    {% include 'pages/dashboard_link.html' with color='primary' href=href_manage_contacts text='Manage Contacts' help="Expand your reach by adding people to your list and joining parents circles. The more reach, the better chance you'll find a babysitter." attention_title="Too few contacts" attention_body="Please add more contacts and/or join more parents circles so that Servuno can help you find babysitters among them and their contacts." only %}
  {% else %}
    {% include 'pages/dashboard_link.html' with color='primary' href=href_manage_contacts text='Manage Contacts' help="Expand your reach by adding people to your list and joining parents circles. The more reach, the better chance you'll find a babysitter." only %}
  {% endif %}

{#  {% url 'account_view' as href_account %}#}
{#  {% include 'pages/dashboard_link.html' with color='info' href=href_account text='View Account' help="Review your personal info." only %}#}

  <p class="{% if not favors_karma %}text-muted{% endif %}">
    <span class="">Favors karma <i class="fa fa-question-circle" data-toggle="tooltip" title="Help other parents babysit and have them return the favor when you need help. Paid babysitting is not a favor. Favors will show here 1-2 days after successfully delivered."></i></span>
    {% if favors_karma %}
      {% for favor_user, count in favors_karma %}
      {% with other=favor_user me=target_user %}{% if count > 0 %}
        <span class="label label-success match-favors-label" data-toggle="tooltip" title="{% user-short-name other %} owes you ({% user-short-name me %}) {{ count }} favor{{ count|pluralize }}"><i class="fa fa-balance-scale"></i> {{ count }} {% user-short-name other %}</span>
      {% elif count < 0 %}
        <span class="label label-danger match-favors-label" data-toggle="tooltip" title="You ({% user-short-name me %}) owe {% user-short-name other %} {{ count|negate }} favor{{ count|negate|pluralize }}"><i class="fa fa-balance-scale"></i> {{ count|negate }} {% user-short-name other %}</span>
      {% endif %}{% endwith %}
      {% endfor %}
    {% else %}
      - None -
    {% endif %}
  </p>
{% endblock %}
